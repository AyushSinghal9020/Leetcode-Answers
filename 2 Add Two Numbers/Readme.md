The solution is highly inspired from leetcode user @lackary
